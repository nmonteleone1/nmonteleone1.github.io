import{W as f,s as w,P as m,a as y,S as k,D as g,A as b,T as L,M as v,b as A,c as z,O as M,G as C,V as r,Q as P}from"./vendor.b35c9335.js";const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}};x();class S{constructor(e){this.velocity=new r(0,0,-10),this.decceleration=new r(0,-.01,0),this.acceleration=new r(0,.25,-10),this.input=new F,this.statemachine=new E,this.target=e}Update(e){const s=this.velocity,a=new r(0,0,s.z*this.decceleration.z);a.multiplyScalar(e),s.add(a);const t=this.target,i=new P,o=new r,d=t.quaternion.clone(),n=this.acceleration.clone();this.input.keys.forward&&(s.z+=n.z*e),this.input.keys.left&&(o.set(0,1,0),i.setFromAxisAngle(o,4*Math.PI*e*this.acceleration.y),d.multiply(i)),this.input.keys.backward&&(s.z-=n.z*e),this.input.keys.right&&(o.set(0,1,0),i.setFromAxisAngle(o,4*-Math.PI*e*this.acceleration.y),d.multiply(i)),t.quaternion.copy(d);const l=new r;l.copy(t.position);const u=new r(0,0,1);u.applyQuaternion(t.quaternion),u.normalize();const c=new r(1,0,0);c.applyQuaternion(t.quaternion),c.normalize(),s.z=Math.max(Math.min(-10,s.z),-50),c.multiplyScalar(s.x*e),u.multiplyScalar(s.z*e),t.position.add(u),t.position.add(c),l.copy(t.position)}}class F{constructor(){this.Init()}Init(){this.keys={forward:!1,left:!1,backward:!1,right:!1,space:!1},document.addEventListener("keydown",e=>this.onKeyDown(e),!1),document.addEventListener("keyup",e=>this.onKeyUp(e),!1)}onKeyDown(e){switch(e.keyCode){case 87:this.keys.forward=!0;break;case 65:this.keys.left=!0;break;case 83:this.keys.backward=!0;break;case 68:this.keys.right=!0;break;case 32:this.keys.space=!0;break}}onKeyUp(e){switch(e.keyCode){case 87:this.keys.forward=!1;break;case 65:this.keys.left=!1;break;case 83:this.keys.backward=!1;break;case 68:this.keys.right=!1;break;case 32:this.keys.space=!1;break}}}class E{constructor(){}}class O{constructor(e,s){this.camera=e,this.target=s,this.currentPosition=new r,this.currentLookat=new r}CalculateIdeals(){const e=new r(0,30,20),s=new r(0,0,-20);return e.applyQuaternion(this.target.quaternion),e.add(this.target.position),s.applyQuaternion(this.target.quaternion),s.add(this.target.position),{idealOffset:e,idealLookat:s}}Update(e){const s=this.CalculateIdeals(),a=s.idealOffset,t=s.idealLookat;this.currentPosition.copy(a),this.currentLookat.copy(t),this.camera.position.copy(this.currentPosition),this.camera.lookAt(this.currentLookat)}}class R{constructor(){this.Initialize()}Initialize(){this.renderer=new f({antialias:!0}),this.renderer.outputEncoding=w,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=m,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),window.addEventListener("resize",()=>{this.OnWindowResize()},!1);const e=10,s=e+20;this.camera=new y(75,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.y=s,this.scene=new k;const a=new g(16777215,.5);a.position.set(-100,100,100),a.target.position.set(0,0,0),a.castShadow=!0,a.shadow.bias=-.001,a.shadow.mapSize.width=4096,a.shadow.mapSize.height=4096,a.shadow.camera.near=.5,a.shadow.camera.far=500,a.shadow.camera.left=50,a.shadow.camera.right=-50,a.shadow.camera.top=50,a.shadow.camera.bottom=-50;const t=new b(16777215,.25);this.scene.add(a,t);const i=new L,o=i.load("earth_texture_map.jpg"),d=i.load("earth_normal_map.jpg"),n=new v(new A(2048,1024,10,10),new z({map:o,normalMap:d}));n.castShadow=!1,n.receiveShadow=!0,n.rotation.x=-Math.PI/2,this.scene.add(n);const l=new M;new C().load("plane.glb",c=>{c.scene.traverse(p=>{p.castShadow=!0,p.rotation.y=Math.PI/2,p.position.set(0,e,0)}),l.add(c.scene)}),this.scene.add(l),this.controller=new S(l),this.cameraController=new O(this.camera,this.controller.target),this.mixers=[],this.previousRAF=null,this.focus=!0,this.Animate(),window.addEventListener("blur",()=>{this.focus=!1}),window.addEventListener("focus",()=>{this.focus||(this.focus=!0,this.Animate())})}Step(e){const s=e*.001;this.mixers&&this.mixers.map(a=>a.update(s)),this.controller&&this.controller.Update(s),this.controls,this.cameraController.Update(s)}Animate(){!this.focus||requestAnimationFrame(e=>{(this.previousRAF===null||e-this.previousRAF>100)&&(this.previousRAF=e),this.Animate(),this.renderer.render(this.scene,this.camera),this.Step(e-this.previousRAF),this.previousRAF=e})}}window.addEventListener("DOMContentLoaded",()=>{new R});
